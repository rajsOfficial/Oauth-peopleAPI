<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- The HTML 4.01 Transitional DOCTYPE declaration-->
<!-- above set at the top of the file will set     -->
<!-- the browser's rendering engine into           -->
<!-- "Quirks Mode". Replacing this declaration     -->
<!-- with a "Standards Mode" doctype is supported, -->
<!-- but may lead to some differences in layout.   -->

<html>
  <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://apis.google.com/js/client:platform.js?onload=start" async defer></script>
    <script>
   function start(){
	   console.log("into start method");
	   gapi.load('auth2',function(){
		 auth2 = gapi.auth2.init({
			   client_id : '653626272449-575r6b36ae192sjr3jj6lj974j5h5eon.apps.googleusercontent.com',
			  	scope : 'https://www.googleapis.com/auth/contacts.readonly'
		   });
	   });
   }
   
 
   </script>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Hello App Engine</title>
  </head>

  <body>
    <h1>Hello App Engine!</h1>
	
   Sign in with 
   <button id= "signInbut">google</button>
 
	<script>
	  $("#signInbut").click(function(){
		   console.log("into the signinbutton");
			auth2.grantOfflineAccess().then(signInCallback);
			
		});
	function signInCallback(authResult){
		console.log("into callback method");
		if(authResult['code']){
			var obj = {"code" : authResult.code};
			console.log(authResult.code);
			var data = JSON.stringify(obj);
			$.ajax({
				type : "post",
				url : "/login/GoogleLogin",
				headers : "X-Requested-With : XMLHttpRequest",
			  contentType: 'application/json; charset=utf-8',
		      success: function(result) {
		    	  console.log(" Data is "+result);
		      },
		      data: data
			});
		}
		else {
			console.log("Error : Didnt get the Auth code");
		}
	}
	</script>
  </body>
</html>
